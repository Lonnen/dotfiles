
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

function extractWordAtPosition(editor, position, wordRegex) {
  if (!wordRegex) {
    wordRegex = editor.getLastCursor().wordRegExp();
  }
  var buffer = editor.getBuffer();
  var row = position.row;
  var column = position.column;

  var rowRange = buffer.rangeForRow(row);
  var matchData = undefined;
  // Extract the expression from the row text.
  buffer.scanInRange(wordRegex, rowRange, function (data) {
    var range = data.range;

    if (range.containsPoint(position)) {
      matchData = data;
    }
    // Stop the scan if the scanner has passed our position.
    if (range.end.column > column) {
      data.stop();
    }
  });
  if (matchData) {
    return {
      wordMatch: matchData.match,
      range: matchData.range
    };
  } else {
    return null;
  }
}

module.exports = extractWordAtPosition;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLWF0b20taGVscGVycy9saWIvZXh0cmFjdC13b3JkLWF0LXBvc2l0aW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7OztBQVdaLFNBQVMscUJBQXFCLENBQzFCLE1BQXVCLEVBQ3ZCLFFBQW9CLEVBQ3BCLFNBQWtCLEVBQTJDO0FBQy9ELE1BQUksQ0FBQyxTQUFTLEVBQUU7QUFDZCxhQUFTLEdBQUcsTUFBTSxDQUFDLGFBQWEsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDO0dBQ2pEO0FBQ0QsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDO01BQzNCLEdBQUcsR0FBWSxRQUFRLENBQXZCLEdBQUc7TUFBRSxNQUFNLEdBQUksUUFBUSxDQUFsQixNQUFNOztBQUNsQixNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3pDLE1BQUksU0FBUyxZQUFBLENBQUM7O0FBRWQsUUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLFVBQUMsSUFBSSxFQUFLO1FBQ3pDLEtBQUssR0FBSSxJQUFJLENBQWIsS0FBSzs7QUFDWixRQUFJLEtBQUssQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLEVBQUU7QUFDakMsZUFBUyxHQUFHLElBQUksQ0FBQztLQUNsQjs7QUFFRCxRQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFHLE1BQU0sRUFBRTtBQUM3QixVQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDYjtHQUNGLENBQUMsQ0FBQztBQUNILE1BQUksU0FBUyxFQUFFO0FBQ2IsV0FBTztBQUNMLGVBQVMsRUFBRSxTQUFTLENBQUMsS0FBSztBQUMxQixXQUFLLEVBQUUsU0FBUyxDQUFDLEtBQUs7S0FDdkIsQ0FBQztHQUNILE1BQU07QUFDTCxXQUFPLElBQUksQ0FBQztHQUNiO0NBQ0Y7O0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRyxxQkFBcUIsQ0FBQyIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1hdG9tLWhlbHBlcnMvbGliL2V4dHJhY3Qtd29yZC1hdC1wb3NpdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbmZ1bmN0aW9uIGV4dHJhY3RXb3JkQXRQb3NpdGlvbihcbiAgICBlZGl0b3I6IGF0b20kVGV4dEVkaXRvcixcbiAgICBwb3NpdGlvbjogYXRvbSRQb2ludCxcbiAgICB3b3JkUmVnZXg6ID9SZWdFeHApOiA/e3dvcmRNYXRjaDogc3RyaW5nOyByYW5nZTogYXRvbSRSYW5nZX0ge1xuICBpZiAoIXdvcmRSZWdleCkge1xuICAgIHdvcmRSZWdleCA9IGVkaXRvci5nZXRMYXN0Q3Vyc29yKCkud29yZFJlZ0V4cCgpO1xuICB9XG4gIGNvbnN0IGJ1ZmZlciA9IGVkaXRvci5nZXRCdWZmZXIoKTtcbiAgY29uc3Qge3JvdywgY29sdW1ufSA9IHBvc2l0aW9uO1xuICBjb25zdCByb3dSYW5nZSA9IGJ1ZmZlci5yYW5nZUZvclJvdyhyb3cpO1xuICBsZXQgbWF0Y2hEYXRhO1xuICAvLyBFeHRyYWN0IHRoZSBleHByZXNzaW9uIGZyb20gdGhlIHJvdyB0ZXh0LlxuICBidWZmZXIuc2NhbkluUmFuZ2Uod29yZFJlZ2V4LCByb3dSYW5nZSwgKGRhdGEpID0+IHtcbiAgICBjb25zdCB7cmFuZ2V9ID0gZGF0YTtcbiAgICBpZiAocmFuZ2UuY29udGFpbnNQb2ludChwb3NpdGlvbikpIHtcbiAgICAgIG1hdGNoRGF0YSA9IGRhdGE7XG4gICAgfVxuICAgIC8vIFN0b3AgdGhlIHNjYW4gaWYgdGhlIHNjYW5uZXIgaGFzIHBhc3NlZCBvdXIgcG9zaXRpb24uXG4gICAgaWYgKHJhbmdlLmVuZC5jb2x1bW4gPiBjb2x1bW4pIHtcbiAgICAgIGRhdGEuc3RvcCgpO1xuICAgIH1cbiAgfSk7XG4gIGlmIChtYXRjaERhdGEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd29yZE1hdGNoOiBtYXRjaERhdGEubWF0Y2gsXG4gICAgICByYW5nZTogbWF0Y2hEYXRhLnJhbmdlLFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHRyYWN0V29yZEF0UG9zaXRpb247XG4iXX0=
